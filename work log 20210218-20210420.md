# 2021-02/18 - 20，02/22-23 am.（sp 21）

## 24-25-26 QA/UAT/REVIEW



## 02/18

- https://theplanttokyo.atlassian.net/browse/MDX-1740 Apply new RA symbol for JMA // Done

  > Figma:
  >
  > https://www.figma.com/file/v4N3VVFPMI86shHX8TDxm8/MDX-1963%3A-New-RA-Symbol-Image?node-id=0%3A1

- mdx1969: Replace JMA splash image //PR merged

- mdx1967: Value Stamp Card Design Change // PR merged

  - 剩余更新图片的子任务，需要获得新图片后导出后，交给 CMS 上传
  
- mmf122: Android > Stamps page display several times. // Merged

- mdx1984: Update SDK to v3.2.0 // Done

  - 只升级了 sdk，依然使用 deprecated 的 authorizeExternalPayment 方法（lin 说先继续使用老的方法）

- 同步 https://theplanttokyo.atlassian.net/browse/MDX-1580 (**in backlog**)

  > Some existing postal code is blocked as "not correct" on account information update

  同步 https://theplanttokyo.atlassian.net/browse/MDX-1972 (**in backlog**)

  > [Android] Duplicate Product Image call

- 执行，调研 mdx1887: [Android] Coloring book PDF does not download (**in backlog**)

  - 背景：Android webview 不支持 pdf 预览，支持文件下载

  - 和 lin 讨论过，2 sp 的估时对应的方案是使用 google doc 方式进行外部文件加载到 webview 预览：

    ```kotlin
    // 样例代码：
    url = "https://www.mcdonalds.co.jp/media_library/6523/file.pdf"
    webView.loadUrl("https://docs.google.com/gview?embedded=true&url=$url")
    ```

    - 结论：结果不太好。写了一个小 demo，vpn 的情况下经常会出现加载不出的情况（显示空白）。明天考虑用日本的网络尝试下。如果情况还是不好，需要考虑使用别的方案
    - 状态更新：日本的网络也会出现加载不出的情况，考虑使用其他方法预览 pdf



## 02/19

- https://theplanttokyo.atlassian.net/browse/MDX-1887 [Android] Coloring book PDF does not download

  状态：Blocked

  > 测试了日本的网络下，使用 webview 加载 google doc 嵌套 online pdf 也会经常出现加载不出来的情况。可能需要考虑其他方案

- https://theplanttokyo.atlassian.net/browse/MDX-1967 Value Stamp Card Design Change

  状态：完成

  > 使用 3 个 Stamp 就能兑换 Coupon 的新规则（替代原来的 4 个兑换），修改对应逻辑和 UI 

- 查看 https://theplanttokyo.atlassian.net/browse/MDX-1718 [Android] d point bug with registering the d point tag when the customer's first login

  状态：未开始

  > 过了一下讨论内容，还有些东西没理解，可能需要结合代码去了解才能改

- 查看 https://theplanttokyo.atlassian.net/browse/MDX-1998 [Android] I can't add to the cart when I choose Potenage DAI, Potenage TOKUDAI

  状态：已定位错误，在看代码熟悉流程

  

## 02/20

- https://theplanttokyo.atlassian.net/browse/MDX-1998 [Android] I can't add to the cart when I choose Potenage DAI, Potenage TOKUDAI

  状态：已定位错误 -> 暂停

- https://theplanttokyo.atlassian.net/browse/MMF-165 Some products missing 'Coffee'

  状态：完成（查明原因告诉 QA，不需要修改）

- https://theplanttokyo.atlassian.net/browse/MMF-163 RA symbol looks smaller than design.

  状态：完成（布局调整完毕，如果还需要更贴合设计，需要替换 cms api 返回的图片）

- https://theplanttokyo.atlassian.net/browse/MMF-169 Button is unclickable when scroll to bottom

  状态：查明原因，由于 html 页面固定了高度并且对内部元素使用了 overflow:scroll 导致内部元素可滑动

  - 1）导致 webview 无法接收到 onScrollChanged 事件
  - 2）在判断 webview 是否可进行垂直向下滑动的结果上一直为 false（这导致无法判断是否到达最底部）

  由于 1）2）导致老的监听失效，同时也无法使用其他监听替代

  **需要客户去修改 html 页面样式**

- https://theplanttokyo.atlassian.net/browse/MMF-112 Header issues

  状态：待查



## 02/22

- https://theplanttokyo.atlassian.net/browse/MMF-163 RA symbol looks smaller than design.

  状态：cms 提供了新图片地址，已替换

- https://theplanttokyo.atlassian.net/browse/MMF-169 Button is unclickable when scroll to bottom

  状态：和 nate 沟通，告知原因，nate 去掉 overflow CSS 样式后，功能测试通过

- https://theplanttokyo.atlassian.net/browse/MDX-1967 Value Stamp Card Design Change

  状态：样式修改完成，并告知 QA 关于 Card 的测试需求

- https://theplanttokyo.atlassian.net/browse/MMF-112 Header issues

  状态：Blocked。特殊操作下一定能复现。vivo X21A 机器出现概率大。感觉 HTML JS 的原因可能性比较高，明天需要和前端再排查



## 02/23

- https://theplanttokyo.atlassian.net/browse/MMF-172 The number is not consistent with design.

  状态：修复

- https://theplanttokyo.atlassian.net/browse/MMF-174 Text style broken.

- https://theplanttokyo.atlassian.net/browse/MMF-112 Header issues

  状态：174，112 都是因为 header 原因。查明 header 没有被隐藏的浅层原因是由于页面未完全加载，具体到有一个 mcd 的 js 文件无法加载下来，再深层的原因无法查明。

  因此，无法针对性的修复。换了一种思路，在页面无法完全加载的情况下使用 JS 注入执行隐藏 header。修复

```
var $header=document.querySelector(".container-header");
var $footer=document.querySelector(".footer-container");
var $sns = document.querySelector("#freestyle-apps-sns");
var $hidden = document.querySelectorAll("[id^='js-hybrid-hidden']");
$header && $header.remove();
$footer && $footer.remove();
$sns&& $sns.remove();
$hidden && $hidden.length && $hidden.forEach(function(hide){hide.remove()});

var headerE =document.querySelector(".container-header");
var footerE =document.querySelector(".footer-container");
var snsE = document.querySelector("#freestyle-apps-sns");
var hiddenE = document.querySelectorAll("[id^='js-hybrid-hidden']");
headerE && headerE.remove();
footerE && footerE.remove();
snsE && snsE.remove();
hiddenE && hiddenE.length && hiddenE.forEach(function(hide){hide.remove()});
```



## 02/24

- https://theplanttokyo.atlassian.net/browse/MMF-173 Missing text.

  状态：完成

- https://theplanttokyo.atlassian.net/browse/MDX-1972 Duplicate Product Image call

  状态：同步，处理冲突，提交 PR，已合并到最新包

- https://theplanttokyo.atlassian.net/browse/MDX-1580 postal code

  状态：提交 PR，已合并到最新包

- https://theplanttokyo.atlassian.net/browse/MMF-176  Have to tap '<' two times to close webview

  状态：查明原因，和之前代码的事件注册发生事件广播冲突。使用另外的方式启动 webview。修复完成

  

  
## 02/25

- Code review 完成

- https://theplanttokyo.atlassian.net/browse/MMF-142 Missing distance

  状态：hold。测试了多个系统版本。无法重现

- 补全任务的 Actual SP

- 帮助 QA 验证 RA 图片各数据显示的正确性

  > 完整菜单数据 api
  >
  > STAG：https://cms-cdn.mcd.theplant-dev.com/api/v1/product_menu.json
  >
  > UAT：https://www.stg.mcd.qorcommerce.com/api/v1/product_menu.json
  >
  > PROD：https://www.mcdonalds.co.jp/api/v1/product_menu.json
  >
  > 
  >
  > is_rainforest_alliance_certified = true，显示没有 Coffee 的 RA 图
  >
  > is_rainforest_alliance_certified_coffee = true，显示带 Coffee 的 RA 图

  



## 02/26

- 浏览 sprint22 issues

- https://theplanttokyo.atlassian.net/browse/MDX-2018 [Android] Update d point SDK version up to 1.12.01 (as of Feb. 19th 2021)

  状态：查看了 d point sdk 文档

- https://theplanttokyo.atlassian.net/browse/MMF-186 Value lunch campaign deeplink > Fail to open

  状态：确认 bug。无需修改

- 下午参加 WebMop 技术会议





# 2021 03/01 - 03/09 (周二) DEV （sp 22）

## 03/10-11-12 QA/UAT/Review



## 03/01

- https://theplanttokyo.atlassian.net/browse/MDX-2011 Increase the PDP image size

  状态：完成。

  > 发现 PDP 的产品 URL 使用的和 MenuTab 不是相同的 URL：PDP 使用 PLX 的，Menu 是 CMS 的
  >
  > PDP：https://mopstgfd.plexure.io/product-images/product_mobile/1912
  >
  > MenuTab：https://www.mcdonalds.co.jp/product_images/164/4540-Bai-Filet-O-Fish.m.png?20201202102942
  >
  > 这里也许会增加任务[https://theplanttokyo.atlassian.net/browse/MDX-1904 PDP Gif] 的耗时

- https://theplanttokyo.atlassian.net/browse/MDX-2018 [Android] Update d point SDK version up to 1.12.01

  状态：完成

  > 注册 dpoint 账号，确认 barcode 显示
  >
  > 替换 sdk
  >
  > 用注册的账号测试 barcode 的显示



## 03/02

- https://theplanttokyo.atlassian.net/browse/MDX-1977 Optimize JMA API Cache	

  - /api/v1/announcements.json 数据缓存完成
  - **在修改 /api/v1/startup_ads.json 发现这样的问题**：

    当前 /api/v1/startup_ads.json 请求（获取弹窗广告）发生在闪屏页面，并非主页面，现有的 api/v1/lastupdate.json（获取数据修改时间的请求）发生主页面，即 /api/v1/startup_ads.json 发生在 api/v1/lastupdate.json 之前。

    如果要对 /api/v1/startup_ads.json 数据进行缓存，那么通过 api/v1/lastupdate.json 获取修改时间必须发生在 /api/v1/startup_ads.json 之前。那么这里实现细节上该如何选择？	

    1. 把 /api/v1/startup_ads.json 请求后移到主页面
    2. 在 /api/v1/startup_ads.json 之前再加一个 api/v1/lastupdate.json，这样启动 app 的时候会有两个 api/v1/lastupdate.json



## 03/03

- https://theplanttokyo.atlassian.net/browse/MDX-1977 Optimize JMA API Cache
  - 完成
  - 完成测试：使用 Charles 修改 api/v1/lastupdate.json 的 Response 数据，并分别测试 /api/v1/announcements.json & /api/v1/startup_ads.json 
- https://theplanttokyo.atlassian.net/browse/MDX-2008 Android SDK Debugging and Upgrade 
  - 状态：Blocked。升级了sdk 版本，出现错误，无法运行，还在查原因，大概率是由于依赖冲突。明天继续查（3sp）



## 03/04

- https://theplanttokyo.atlassian.net/browse/MDX-2008 Android SDK Debugging and Upgrade 

  > 自测清单：
  >
  > - 登入注册
  > - 首页 news 显示
  > - 下单流程

- 合并已完成的开发任务[分支]到 v5.1.80

  - **https://theplanttokyo.atlassian.net/browse/MDX-2018 [Android] Update d point SDK version up to 1.12.01**
  - **https://theplanttokyo.atlassian.net/browse/MDX-2011 Increase the PDP image size**
  - **https://theplanttokyo.atlassian.net/browse/MDX-1977 Optimize JMA API Cache**	
  - **https://theplanttokyo.atlassian.net/browse/MDX-2008 Android SDK Debugging and Upgrade** 

- 兼容性测试

  背景：由于当前 app 向下支持到 api19（Android4.4），但是 d point SDK(v1.12.01 ) minsdk 是 api 21，vmobsdk(v5.06.5) minsdk 是 api 23，为了运行已经把把 minsdk override。

  结果：**api19 虚拟机运行崩溃，查明原因，意外的发现是 overflow 导致的，当前已修复**；

  dpoint sdk 运行无异常；(**PS，发现 rpoint sdk 只支持 api21，因此 api19 的机器其实 pointcard 是无法使用的**)

  vmobsdk 由于功能比较多，自测了账户相关的和下单流程，无问题。

  **但是，vmobsdk 的 sdk 因为依赖 `androidx.security:security-crypto:1.0.0-rc01` 才要求 minsdk=23，官网文档说明：**

  > **Note:** [Version 1.0.0 of the Security library](https://developer.android.com/jetpack/androidx/releases/security#version_100_2) is supported on devices that run Android 6.0 (API level 23) and higher. A newer version of the library [supports additional Android versions](https://developer.android.com/topic/security/data-android-versions).

  **因此建议询问一下 vmobsdk 提供方这个 Security lib 是用在什么功能上，针对的测试一下功能是否有效，或者该功能是否做过向下兼容**

- https://theplanttokyo.atlassian.net/browse/MDX-2019 Add to Cart CTA in Generic JMA PLP

  状态：查看了新设计稿，看了部分流程代码，还未开始改动



## 03/05

https://theplanttokyo.atlassian.net/browse/MDX-2019 Add to Cart CTA in Generic JMA PLP

状态：完成。

从 menuTab 进入产品详情页面的需要传入 Category 参数，对应 Featured，Burger，Set，Sides...，因为在产品详情页面会用于统计，现在从主页的推荐产品（Title：Featured）进入产品详情页面是否需要传入类型？



## 03/08

- https://theplanttokyo.atlassian.net/browse/MDX-1998 [Android] I can't add to the cart when I choose Potenage DAI, Potenage TOKUDAI

状态：之前发现问题的代码 FIXED，但是还需要对任务描述里面的真机进行测试验证



## 03/09 

- https://theplanttokyo.atlassian.net/browse/MDX-1998 [Android] I can't add to the cart when I choose Potenage DAI, Potenage TOKUDAI

状态：找了几个提供远程真机的平台，只有阿里云提供了远程真机 Sony Xperia 1，测试之后发现之前发现的问题和这个不是同一个问题。**问题的原因：厂商 rom 对布局控件参数的处理不一样，修改布局：修复**



## 03/10

修复 bugs：

- https://theplanttokyo.atlassian.net/browse/MMF-194 Underscore is weird. 

  状态：fixed

- https://theplanttokyo.atlassian.net/browse/MMF-193 Different behavior. 

  状态：fixed

- https://theplanttokyo.atlassian.net/browse/MMF-196 Doesn't display 'Snack' start up 

  状态：得先确定业务逻辑的正确与否。正确的情况，需要 qa 填入 url 之后重新测试再看是否需要修改



## 03/11

- https://theplanttokyo.atlassian.net/browse/MMF-209 Image size doesn't increase
  - 放大 generic menu / store / OVF PDP 的产品图
- 检查 https://theplanttokyo.atlassian.net/browse/MDX-1998 OVF 的 Potenage DAI 在 Xperia1 上显示是否正常



## 03/12

- https://theplanttokyo.atlassian.net/browse/MMF-196 Doesn't display 'Snack' start up

  - 整理完整的 Splash 流程给 QA。**该 bug 符合业务逻辑需求，无需修改**

- https://theplanttokyo.atlassian.net/browse/MMF-214 Should not display Cart CTA when product is MOP not available

  > https://theplanttokyo.atlassian.net/browse/MMF-215 相同问题

  - home featured / generic menu。
  - 状态：Fixed

- https://theplanttokyo.atlassian.net/browse/MMF-216 Loading image different with Android

  - 需要修改 generic menu / store / OVF PDP 的产品图的加载等待图
  - 状态：fixed

- https://theplanttokyo.atlassian.net/browse/MMF-220 Needs some padding

  - 加了 26dp。
  - 状态：Fixed



# 2021 03/15-16 17Plan 18-23 周二（DEV）sp 23

## 24-25-26 QA/UAT/REVIEW

## 03/15

- https://theplanttokyo.atlassian.net/browse/MMF-211 JMA will crash after register

原因已查明：结论：OVF 相关的代码调用了用于调试的代码（具体为 MyApplication.track() 方法），但是在发生这一步的时候用户数据信息还并不一定已经缓存到了本地，因此会出现获取 email 为 null 的情况，因此发生了直接操作 email 数据的情况发生了 nullpointException

> 用户数据缓存到本地和 ovf 代码调用 MyApplication.track() 这两个执行是异步的，无法保证顺序，使用公司的 vpn 的时候特别明显

处理：由于 track 方法只是用于调试的，不涉及到核心功能，因此当前只对 email 做非空处理应该也可作为修复手段。



## 03/16

- https://theplanttokyo.atlassian.net/browse/MMF-207 Can not log in with twitter/Facebook.

  - 视频中实际上出现了两个 bug，其一是崩溃，原因同 MMF-211，Fixed
  - 其二为 "not a menber" 登录失败错误，个人设备无法重现。**QA 反馈，该错误出现的频率比较小，可以先 Hold**

- https://theplanttokyo.atlassian.net/browse/MDX-2077  Analytic event for new add to Cart CTA on JMA PLP

  - ```yaml
    event: mop_start
    bundle: 
    	entrance_screen: menu_generic_${category}
    	screen_component: order_start_cta
    	
    event: tapCart
    buundle:
    	item_name:
    	item_id:
    	item_category2:
    	price:
    	currency: "JPY"
    	menu_name: "featured"/"coupon"/"burgers"
    ```

  - 装态：90%代码已经写完，还有一个问题需要确认
  
  - PR：https://github.com/theplant/mcd-android/pull/69



## 03/17 PLAN

- https://theplanttokyo.atlassian.net/browse/MDX-2087 [Value Lunch Stamp] Text modification

  - 状态：done

- 调研是否可以基于当前图片框架实现 gif 方案，相关任务：

  - https://theplanttokyo.atlassian.net/browse/MDX-1904 Add Animations To Select Product Tiles
  - https://theplanttokyo.atlassian.net/browse/MMF-140 The gif doesn't work.

  背景：当前项目中类似 gif 动画效果是采用的是 SurfaceView 循环帧数组以及帧动画（也是循环播放帧数组），对网络 gif 图的支持上不可行。因此得另外找方案去完成网络 gif 图的播放
  

结论：同时当前图片框架 Picasso 不支持 gif，且暂无其对 gif 支持的补充，并且直接和其他的第三方 gif 控件库一起使用存在不兼容的问题。**因此还需要花时间再寻找下其他可行方案**

  


## 03/18 - 19

- gif 继续调查结果：Picasso 加载 gif 转为 bitmap 后只保留了一帧，并且提供的方法和接口无法获取到原始 gif 数据。自己用 http 加载原始 gif 数据然后使用 gifimageview 控件显示又缺少缓存机制。最好的方法估计还是使用第三方开源图片框架 glide

- https://theplanttokyo.atlassian.net/browse/MDX-2033 [Analytics] Track grill order

  - 了解 grill 功能的业务需求，查看调试代码逻辑，执行 track 事件的添加，实际消耗 5 sp
  - **代码已经添加* 但是追踪事件的 price 字段的具体内容还需要再确认下，当前使用的是购物车的 price 值

- https://theplanttokyo.atlassian.net/browse/MDX-1976 Investigate and decide if new d point (account connect) should be integrated

  - 状态：花了 3 个 sp查看了大致的流程，但是对 account connect 这个事情的目的和实现还是不是很了解

  

## 03/22

- https://theplanttokyo.atlassian.net/browse/MDX-2033 [Analytics] Track grill order
  - 确定 price 字段 track 内容，修改 2 sp
  - 修改 ingredient track 的内容，添加了 product 信息，修改 2sp
- https://theplanttokyo.atlassian.net/browse/MMF-227 Show different product between IOS and Android
  - Android 从 Config 里面得到的产品 id 数据源确实是 6 个，为啥 ios 会只有 5 个需要 neo 那边先看下逻辑
- https://theplanttokyo.atlassian.net/browse/MMF-235 Android logout doesn't work on 6/10 devices
  - 已复现，还在调试查原因



## 03/23

- https://theplanttokyo.atlassian.net/browse/MMF-227 Show different product between IOS and Android

  - ios 比 android 多了一段产品是否在有效期内的条件过滤，因此过滤掉了一个数据（比 android 少了一个数据）

- https://theplanttokyo.atlassian.net/browse/MMF-235 Android logout doesn't work on 6/10 devices

  - vmobsdk 异常报错：co.vmob.sdk.VMobException: Invalid Environment Id for crossReference
  - 属于之前版本就有的问题，先调查更深的原因，即使修复也先不合并

  



## 03/24

- 调查 duplicated image call 问题，结论：

1. product 的 ImageUrl 和 option 里的一个ImageUrl 相同，并发请求，图片缓存无法保证，可能会出现两次相同的 imageUrl call

2. option 里的 imageUrl 重复 call 的问题，是由于 option 列表刷新了两次，加载图片的代码执行了 2x3 次（option 3 个情况）所以有时候会看到最后一个 option 的 imageUrl call 了两次，甚至有时候 3 个 option 的 imageUrl 都 call 了两次

   > 1 的情况我觉得可以不去管，2 的情况是可以优化的，不过要看时间安排

- https://theplanttokyo.atlassian.net/browse/MMF-235 Android logout doesn't work on 6/10 devices

  - 深入了 vmobsdk 的源代码，错误发生在调用创建 FCM CrossReference 的方法 

    ```
    FCMUtils.createFcmCrossReference -> CrossReferencesManager.createCrossReference -> a(crossReferenceType != null ? crossReferenceType.getCode() : null, id, canBeSentBeforeInit, resultCallback) -> 
    
    if (Boolean.valueOf(var1 == null || var1.isEmpty())) {
                if (var3 != null) {
                    var3.onFailure(new VMobException("Invalid Environment Id for crossReference"));
                }
                ...
    }
    
    // id = SharedPreferencesUtils.getString(Key.FCM_REGISTRATION_TOKEN)
    ```

    id 为 FCM 的注册 token，即错误发生的原因是由于存于本地的 FCM token 获取为 null 或者 empty

    FCM 的依赖要求：Android4.1 及其以上并且安装了 Google Play Store（需要 Google Services）

    **换言之，出错的机器如果是国产的机器，那么很可能因为没有安装 Google Play Store，或者阉割到不存在 Google Services，那么 FMC 的 token 在登录注册的时候就没有获取到**

  
  
  
## 03/25 - 26

- Code Review /done
- List the code modify of this sprint for QA /done
- https://theplanttokyo.atlassian.net/browse/MDX-2101 Duplicate product image requests on PDP with options/sizes/variants
  - **已经对饮料栏目列表两次刷新的情况导致多次相同图片请求的情况进行优化**
  - 产品大图和和选项中如果图片 url 相同这里是否需要优化还有待商榷，优化方案倒是有
- https://theplanttokyo.atlassian.net/browse/MDX-1887 Coloring book PDF does not download
  - 继续调查和尝试 pdf 可行性方案





# Sprint 24: 2021 03/29-30 31Plan 4/01-06 DEV 

## 4/07-08 DEV 09 QA 10-12 DEV 

## 4/13-14 QA/UAT 15-20 PLX VER/Release



## 03/29 Mon.

- 查看 SpCache.checkFreshness NPE 问题 from firebase crashlytics 

  结论：kt 调用 java code，方法入参为 null，但是未加?会导致 crash，null 的原因可能是老代码 BaseApi 的解析问题，也可能是 api 返回数据有偶尔出现 null 的问题，无法确定

  - 状态：fixed

- https://theplanttokyo.atlassian.net/browse/MDX-2101 Duplicate product image requests on PDP with options/sizes/variants

  - 产品大图和和选项中如果图片 url 相同优化问题的解决。并没做直接的优化，而且修改了 PLP 的图片加载代码的缓存使用，由于 PLP 的图片和产品大图的图片 url 是相同的，因此 PLP 图片加载完成的情况基本上进入 PDP 是无需重复请求的（因为有缓存，但是由于之前的代码加载图片并未使用同一份缓存，因此出现了过多请求的情况）
  - 同时修改 OVF

  

## 03/30 Tues.

- https://theplanttokyo.atlassian.net/browse/OVF-692  Potenage DAI, Potenage TOKUDAI > Image incomplete.
  
  - 修改 scaleType 为 fitcenter
- https://theplanttokyo.atlassian.net/browse/MDX-2098 Show generic toys regardless of the LTO toys availability
  
  - 调研
- https://theplanttokyo.atlassian.net/browse/MDX-2077  Analytic event for new add to Cart CTA on JMA PLP
  
  - 添加 menu_name: en category
  
  



## 03/30 - 31 Plan

- SpCache.checkFreshness NPE 在 v5.1.90 Fixed/Merged

- https://theplanttokyo.atlassian.net/browse/MDX-2077  Analytic event for new add to Cart CTA on JMA PLP

  - 添加 menu_name: en category
  - 修复事件字段 Price 的值

  status：PR created

- https://theplanttokyo.atlassian.net/browse/OVF-692  Potenage DAI, Potenage TOKUDAI > Image incomplete.

  status：修改 scaleType 为 fitcenter。Fixed/Merged

- https://theplanttokyo.atlassian.net/browse/MDX-2098 Show generic toys regardless of the LTO toys availability

  status：确认当前 happySet 产品的选项完全来自 Server，本地并没有做额外逻辑处理

- https://theplanttokyo.atlassian.net/browse/MDX-2116 Push Device Token to Firestore

  status：还在看 firestore 和 firebase auth 文档



## 04/01 - 02

- https://theplanttokyo.atlassian.net/browse/MDX-2116 Push Device Token to Firestore

  status：**Blocked**. 

  - 原因：firebase-firestore 依赖了 protobuf-javalite，OVF 依赖了 protobuf-java，存在重复类冲突。在 exclude 了 protobuf-javalite 后，依然会导致 crash

  - 单独在未合并 OVF 之前的版本实现了这个 issue，数据已经提交，已验证。但是不解决依赖问题就无法完成这个 issue

> perf:19.0.11 -> protobuf-javalite 3.14.0
>
> firebase-firestore:22.1.2 -> protobuf-javalite 3.14.0
>
> protobuf-java-util:3.14.0 -> protobuf-java 3.14.0

- https://theplanttokyo.atlassian.net/browse/MDX-2039 Control function of stamp tab in the coupon

  status: 整理了一份文字和图片的文档，标记了已动态化的，个人认为可动态化还未动态化的，不需要动态化的元素。需要最终确认完哪些元素需要动态化后再近些修改

  

## 04/06 DEV

- 下午 14：00 - 16：00 半年会议
- https://theplanttokyo.atlassian.net/browse/MDX-2039 Control function of stamp tab in the coupon
  - 整理文档并和 nate 确认了所有要修改的内容。明天和 jason 同步需要添加的新字段
- https://theplanttokyo.atlassian.net/browse/MDX-2077  Analytic event for new add to Cart CTA on JMA PLP
  - 和 ios 同步了 track 事件信息



## 04/07 DEV

- https://theplanttokyo.atlassian.net/browse/MDX-2039 Control function of stamp tab in the coupon

  - 和 jason 确定新增字段

  - 确认前 3 个需求（任务 1）

    > https://theplant.slack.com/archives/C019C3FKUJK/p1617768869250200?thread_ts=1617242609.158900&cid=C019C3FKUJK

  - 执行固定文本 -》动态替换



## 04/08 DEV

- https://theplanttokyo.atlassian.net/browse/OVF-751 Coupon product change to a weird image and return back

  - 查明是老的问题，并非这个 sprint 的 issue 导致的，原因可能是 cache 导致，延后再深入调查原因

- https://theplanttokyo.atlassian.net/browse/MDX-2039 Control function of stamp tab in the coupon

  - VS Auth/Toturial/Term 替换完毕
  - VS Main 95%替换完毕，补充新增 card 单位，产品 title 和 subtitle
    - 还欠 coupon 入口相关的动态文字，文档已补充，明早让 jason 更新 cms api

  > 参考文档：https://docs.google.com/document/d/1SAi4N1qWl_NuPrTUCyCiuDJJ_5T1vZnhxZu-MAB8dKg/edit



## 04/09 QA (VL Image Assets)

- https://theplanttokyo.atlassian.net/browse/MDX-2039 Control function of stamp tab in the coupon
  - 完成 task 2: VS Auth/Toturial/Term/Main 图片文字全部替换完毕
  - 完成 task 1: control stamp tab using remote config 



## 04/12 DEV 6

- https://theplanttokyo.atlassian.net/browse/MDX-2114 Update the link to FAQ

  - url 已经替换。

    - 但是和 ios 对比后发现，网页显示不正常，进入 webview debug 模式后发现网页错误：暂时还无法解决

    ```
    Uncaught TypeError: Cannot read property 'getItem' of null
        at _.getStoredRecentArticles (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at _.articlesWithoutCurrent (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at _.recentArticlesList (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at _.populateRecentArticles (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at recentArticles (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at r.initialize (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at r.initialize (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at r.t.View (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at r [as constructor] (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
        at new r (hc_enduser-1c3c7f65068eb2969f199220010b50e4.js:1)
    bbf1b66……94a5c7ec9cb81.js:81 Uncaught TypeError: Cannot read property 'getItem' of null
        at checkChannelId (bbf1b66434f4dbff54161f101e594a5c7ec9cb81.js:81)
        at HTMLDocument.<anonymous> (bbf1b66434f4dbff54161f101e594a5c7ec9cb81.js:27)
    ```

- https://theplanttokyo.atlassian.net/browse/MDX-2127 VLSC Analytics and event tracking

  - 完成度 90% 
    - 等待 Larry 回复关于 coupon_id 的问题
    - 同意协议处有一个 appflyer 事件追踪，要求传入appflyer userid 的数据，不确定是什么数据





## 04/13 DEV 7

- https://theplanttokyo.atlassian.net/browse/MDX-2127 VLSC Analytics and event tracking
  - 完成。GA 数据 checked，appflyer 数据 checked
- https://theplanttokyo.atlassian.net/browse/MDX-2114 Update the link to FAQ
  - faq url final update
  - 以前写的测试代码可以正常开启 form，对比后发现缺少 setDomStorageEnabled = true。fixed
- https://theplanttokyo.atlassian.net/browse/MDX-2134
  - checked view_promotion and select_promotion track event



## 04/14 DEV/QA/UAT

- https://theplanttokyo.atlassian.net/browse/MMF-270 Value Lunch > Out of date > User with tag >Missing stamp tag
  - debug 单步检查后无异常，后 qa 无法重现，关闭
- https://theplanttokyo.atlassian.net/browse/MMF-274 VLSC > Register image gets cut off
  - jason 替换图片后即 fix
- https://theplanttokyo.atlassian.net/browse/OVF-807 Color of icon looks weird.
  - 判断为手机渲染异常，重启手机 fix



## 04/15 UAT/PLX VER

- https://theplanttokyo.atlassian.net/browse/MMF-278 [ Andriod 256 > FAQ page > Weird arrow.]
  - Fixed。和之前 form 无法显示一样，页面使用了 domStorage，但是之前的 url 的页面不需要这个设置，现在加配
- https://theplanttokyo.atlassian.net/browse/MMF-279 [Android 256 prod > Page not updated]
  - Fixed。每个环境都放了一个 url.xml 来存 inquiry url，且配置都是正式环境的（不明原因），改一次 url 需要改四次
- 整理所有改动过的功能，合并整理给 QA 作为回归测试
- Code Review



## 04/16 UAT/Review

- https://theplanttokyo.atlassian.net/browse/MDX-2116 Push Device Token to Firestore

  - 对 protobuf Android 实现先进行了解

- 测试 banner clickUrl 后面添加不同配置文件是否可以同时进行多个 VSLC 

  - ```
    eg. mcdonaldsjp://cpn-vlstmp2102?config=https://appstore-data.oss-cn-hangzhou.aliyuncs.com/html/valuelunch-stamp-card.json
    ```

  - **结果**：可行。但是格式必须是：mcdonaldsjp://cpn-vlstmp2102?config=valuelunch-stamp-card.json

    - 原因：url 解析后会得到 config 后面的 json 文件名，然后通过 **api**：{{host}}/api/v1/campaigns/ **valuelunch-stamp-card.json** 获取配置内容。IOS 应该也是如此，最开始应该就是这样实现的。clickUrl 后面无 config 参数，默认使用 valuelunch-stamp-card.json

    - 这意味着如果2 个活动同时的话，需要 Jason 再上传一个配置文件，然后在 plx 的后台新建的 banner 的 clickUrl 里面添加config 参数。比如：

      ```json
      Jason 再添加一个：{{host}}/api/v1/campaigns/valuelunch-stamp-card-2015.json
      然后 banner click url 填入：mcdonaldsjp://cpn-vlstmp2102?config=valuelunch-stamp-card-2015.json
      ```

- https://theplanttokyo.atlassian.net/browse/MDX-2039?focusedCommentId=93893 对该视频中出现空白的活动进行调查

  - 用户登录后内容显示只和 {{host}}/api/v1/campaigns/valuelunch-stamp-card.json 文件有关，只要该文件正常获取就应该没有问题。
  - 用户打上 tag：202102_VLMOP_Target & 202102_VLMOP_Participant 进行打开测试。打开clickURl 为 mcdonaldsjp://cpn-vlstmp2102 的 banner 配置活动时间结束和在进行打开页面均都正常，无法重现，需要进一步确认用户 tag 和 banner click Url 情况

​      

## 04/19 Phased Release

- https://theplanttokyo.atlassian.net/browse/MDX-2155 Fix app inquiries page when accessing from Rate this app > Contact US

  > related issue,  [MMF-289](https://theplanttokyo.atlassian.net/browse/MMF-289)

  Fixed/PR

- https://theplanttokyo.atlassian.net/browse/MDX-2149 Purchase event is not including grill items in the item collection

  - 已经确认代码，功能实现上还有几个参数需要和 Larry 确认
