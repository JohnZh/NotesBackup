# 正向代理和反向代理

代理即客户端和服务端的中间人

## 正向

客户端明确发送请求到代理服务器，然后代理服务器转发请求到真正的服务器。真服务器并不知道是代理还是客户端发来的请求（它都认为是客户端）。代理在接收到响应后又会返回给客户端。正向代理的目的是隐藏客户端。

举例：科学上网

## 反向

客户端发生请求到某个域名，通过域名解析到某个服务器，然后这个服务器其实是代理服务器，代理服务器会从很多服务器中找到一台合适的正经服务器，并把请求转给它，正经服务器处理完结果再返回给代理，代理再返回给客户端。反向代理的目的是隐藏服务端。

举例：负载均衡

## 代理与 HTTPS

因此，当客户端使用 https 来与代理，真服务器通信时，客户端必须要信任代理的‘证书’。这也是大部分抓包软件对 https 抓包的处理，生成‘伪证书’，然后交个客户端授信，然后就可以和客户端完成 tls 握手了，因而就可以解密并再次加密客户端的数据，然后发送给真服务端

## 隧道代理

客户端要访问某个服务，会先发生给代理一个 CONNECT 的请求，然后由代理建立一条连接那个服务的 TCP 连接，建立完成之后返回给客户端 HTTP/1.1 200 Connection Established。之后，客户端再发送给代理的任何内容都会被代理盲转，包括 HTTPS 的 TLS 握手，也是进行盲转



